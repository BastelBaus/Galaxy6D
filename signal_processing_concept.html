
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>System Function Overview &#8212; Galaxy6D 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=d45e8c67"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'signal_processing_concept';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="cost estimate (latest, 1/2024)" href="cost_breakdown.html" />
    <link rel="prev" title="Design Concept" href="design_concepts.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Galaxy6D 0.0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="market.html">
    Market overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="design_concepts.html">
    Design Concept
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" current active">
  <a class="nav-link dropdown-item nav-internal" href="#">
    System Function Overview
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="cost_breakdown.html">
    cost estimate (latest, 1/2024)
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="links.html">
    Related links
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="Galaxy6DLib.html">
    Galaxy6DLib
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://hackaday.io/project/192855" title="hackaday" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="https://hackaday.io/favicon.ico" class="icon-link-image" alt="hackaday"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/BastelBaus/Galaxy6D" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="market.html">
    Market overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="design_concepts.html">
    Design Concept
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    System Function Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="cost_breakdown.html">
    cost estimate (latest, 1/2024)
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="links.html">
    Related links
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="Galaxy6DLib.html">
    Galaxy6DLib
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://hackaday.io/project/192855" title="hackaday" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="https://hackaday.io/favicon.ico" class="icon-link-image" alt="hackaday"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/BastelBaus/Galaxy6D" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">System Function Overview</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="system-function-overview">
<h1>System Function Overview<a class="headerlink" href="#system-function-overview" title="Link to this heading">#</a></h1>
<section id="earth-magnetic-field-model">
<h2>Earth Magnetic Field Model<a class="headerlink" href="#earth-magnetic-field-model" title="Link to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(\vec{E}\)</span> be the earth magnetic field with comnponents in all 3 dimensions.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{E} = \begin{pmatrix} m_x \\ m_y \\ m_z \end{pmatrix}\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(\hat{\vec{M}}_i\)</span> be measured magnetic field of the <span class="math notranslate nohighlight">\(i^{th}\)</span>
magnetic field sensor with <span class="math notranslate nohighlight">\(i=1..3\)</span>. Let <span class="math notranslate nohighlight">\(\vec{O}_i\)</span> be the offset
and <span class="math notranslate nohighlight">\(S_i\)</span> be the scale error of the magnetic sensors.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{O}_i = \begin{pmatrix} o_{x,i} \\ o_{y,i} \\ o_{z,i} \end{pmatrix}
\space \space \space  and \space \space \space
S_i = \begin{pmatrix} s_{x,i} &amp; 0 &amp; 0 \\ 0 &amp; s_{y,i} &amp; 0 \\ 0 &amp; 0 &amp; s_{z,i} \end{pmatrix}\end{split}\]</div>
<p>Let $vec{K}_i$ be the signal at each sensor induced by the permanent magnets. With the rotation matrixes $D_i$ for each magnetic sensor we can get the measured magnetic field $hat{vec{M}}_i$ for each sensor by;</p>
<div class="math notranslate nohighlight">
\[\hat{\vec{M}}_i = D_i \cdot S_i \cdot \vec{E} + \vec{O}_i + \vec{K}_i\]</div>
<p>For ease of formulation we define the $1^{st}$ as reference of the Galaxy6D. Then we can define the three
rotation matrixes quite easily by 3 angles (<span class="math notranslate nohighlight">\(\alpha_1=\beta_1=\gamma_1=0?\)</span>) defining the overall knob
position as well as 2 angles (<span class="math notranslate nohighlight">\(alpha_2=120°\)</span> and <span class="math notranslate nohighlight">\(alpha_3=-120°\)</span>) from the design of the position
of the magnetic sensors (see also <a class="reference external" href="https://en.wikipedia.org/wiki/Rotation_matrix">Wikipedia</a>).</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}D_1 = \begin{pmatrix} cos(\alpha_1) &amp; -sin(\alpha_1) &amp; 0 \\ sin(\alpha_1) &amp; cos(\alpha_1) &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix} *
\begin{pmatrix} cos(\beta_1) &amp; 0 &amp; sin(\beta_1) &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ -sin(\beta_1) &amp; 0 &amp; cos(\beta_1)  \end{pmatrix} *
\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; cos(\gamma_1) &amp; -sin(\gamma_1) \\ 0 &amp; sin(\gamma_1) &amp; cos(\gamma_1) \end{pmatrix} =
\begin{pmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{pmatrix}\end{split}\\\begin{split}D_2 = D_1 \cdot \begin{pmatrix} cos(\alpha_2) &amp; -sin(\alpha_2) &amp; 0 \\ sin(\alpha_2) &amp; cos(\alpha_2) &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{pmatrix} =
\begin{pmatrix} -0.5 &amp; -\sqrt{3}/2 &amp; 0 \\ \sqrt{3}/2 &amp; -0.5 &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{pmatrix}\end{split}\\\begin{split}\space \space \space and \space \space \space
D_3 = D_1 \cdot \begin{pmatrix} cos(\alpha_3) &amp; -sin(\alpha_3) &amp; 0 \\ sin(\alpha_3) &amp; cos(\alpha_3) &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{pmatrix} =
\begin{pmatrix} -0.5 &amp; \sqrt{3}/2 &amp; 0 \\ -\sqrt{3}/2 &amp; -0.5 &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{pmatrix}\end{split}\end{aligned}\end{align} \]</div>
<p>As first test, we will only rotate the whole knob, this considering $vec{K}_i$ just be included in $vec{O}_i$ as additional (temporal constant) offset. We will design a Kalman filter to fuse the 3 sensors and estimate the earth magnetic field as well as the scale factor errors and offset. Basically we are only interested in the offset (and there only the part induced by the permanent magents) but this will be done on the second part of the model.</p>
<p>We start with the state vector $vec{S}$ holding the 3D earth magnetic field ($vec{M}$), the 3 offsets  ($vec{O}_i$) and scale factor errors  (diagonal elements of $S_i$ namely $diag{S}_i$) of each magnetic sensors. In total this sum’s up to 21 states.
$$ vec{S} = begin{pmatrix} vec{M} &amp; vec{O}_1 &amp; vec{O}_2 &amp; vec{O}_3 &amp; diag(S_1) &amp; diag(S_2) &amp; diag(S_3) end{pmatrix}^T $$</p>
<p>The Observation matrix $H$ can be calculated as;</p>
<div class="math notranslate nohighlight">
\[\hat{\vec{M}} = \begin{pmatrix}  \hat{\vec{M}}_1 &amp; \hat{\vec{M}}_2 &amp; \hat{\vec{M}}_3 \end{pmatrix} ^T =
\begin{pmatrix}  \hat{\vec{M}}_1 &amp; \hat{\vec{M}}_2 &amp; \hat{\vec{M}}_3 \end{pmatrix} * \vec{S}\]</div>
<p>We will use a Python toolbox to implement the Kalman filter (see <a class="reference external" href="https://github.com/boschresearch/nonlinest">nonlinest</a>).</p>
</section>
<section id="adding-angular-rates-to-the-kalman-filter">
<h2>Adding angular rates to the Kalman filter<a class="headerlink" href="#adding-angular-rates-to-the-kalman-filter" title="Link to this heading">#</a></h2>
<p>&lt;br&gt;&lt;hr&gt;
&gt;&gt; Back to  <strong>[main page](index.md)</strong> &lt;br&gt;
&gt;&gt; Go to <strong>[main repository](https://github.com/BastelBaus/Galaxy6D)</strong></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="design_concepts.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Design Concept</p>
      </div>
    </a>
    <a class="right-next"
       href="cost_breakdown.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">cost estimate (latest, 1/2024)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#earth-magnetic-field-model">Earth Magnetic Field Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-angular-rates-to-the-kalman-filter">Adding angular rates to the Kalman filter</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/signal_processing_concept.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, BastelBaus.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>